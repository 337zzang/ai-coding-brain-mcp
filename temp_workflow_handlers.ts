"import { ToolResult } from '../types/tool-interfaces';\nimport { logger } from '../services/logger';\n\ninterface FlowProjectResult {\n    success: boolean;\n    project_name?: string;\n    path?: string;\n    git_branch?: string;\n    workflow_status?: any;\n    error?: string;\n    details?: any;\n}\n\nexport async function handleFlowProject(params: { project_name: string }): Promise<ToolResult> {\n    const code = `\n# ê°œì„ ëœ flow_project í•¸ë“¤ëŸ¬ - ëª…ì‹œì  ì—ëŸ¬ ì²˜ë¦¬\nimport sys\nimport os\nimport json\nimport traceback\nfrom pathlib import Path\n\nproject_name = \"${params.project_name}\"\nresult = {\n    \"success\": False,\n    \"project_name\": project_name,\n    \"error\": None,\n    \"details\": {}\n}\n\ntry:\n    # 1. Python ê²½ë¡œ ì„¤ì •\n    current_dir = Path.cwd()\n    python_dir = current_dir / 'python'\n    if python_dir.exists() and str(python_dir) not in sys.path:\n        sys.path.insert(0, str(python_dir))\n\n    # 2. enhanced_flow import\n    try:\n        from enhanced_flow import cmd_flow_with_context\n    except ImportError as e:\n        result[\"error\"] = f\"enhanced_flow ëª¨ë“ˆ import ì‹¤íŒ¨: {str(e)}\"\n        result[\"details\"][\"import_error\"] = traceback.format_exc()\n        print(json.dumps(result, ensure_ascii=False))\n        sys.exit(1)\n\n    # 3. í”„ë¡œì íŠ¸ ì „í™˜ ì‹¤í–‰\n    try:\n        flow_result = cmd_flow_with_context(project_name)\n\n        if flow_result and isinstance(flow_result, dict):\n            result[\"success\"] = True\n            result[\"path\"] = flow_result.get(\"project_path\", os.getcwd())\n            result[\"git_branch\"] = flow_result.get(\"git_branch\", \"unknown\")\n            result[\"workflow_status\"] = flow_result.get(\"workflow_status\", {})\n            result[\"details\"] = flow_result\n        else:\n            result[\"error\"] = f\"ì˜ˆìƒì¹˜ ëª»í•œ ë°˜í™˜ê°’: {type(flow_result)}\"\n            result[\"details\"][\"return_value\"] = str(flow_result)\n\n    except Exception as e:\n        result[\"error\"] = f\"í”„ë¡œì íŠ¸ ì „í™˜ ì¤‘ ì˜¤ë¥˜: {str(e)}\"\n        result[\"details\"][\"traceback\"] = traceback.format_exc()\n        result[\"details\"][\"exception_type\"] = type(e).__name__\n\n    # 4. ê²°ê³¼ ì¶œë ¥\n    print(json.dumps(result, ensure_ascii=False, indent=2))\n\nexcept Exception as e:\n    # ìµœìƒìœ„ ì˜ˆì™¸ ì²˜ë¦¬\n    result[\"error\"] = f\"ì¹˜ëª…ì  ì˜¤ë¥˜: {str(e)}\"\n    result[\"details\"][\"fatal_traceback\"] = traceback.format_exc()\n    print(json.dumps(result, ensure_ascii=False, indent=2))\n    sys.exit(1)\n`;\n\n    try {\n        // ì„ì‹œ ëŒ€ì²´ êµ¬í˜„\n    const session = null; // TODO: ì‹¤ì œ ì„¸ì…˜ ê´€ë¦¬ êµ¬í˜„ í•„ìš”\n        const execResult = await session.execute(code, 'python');\n\n        // ì‹¤í–‰ ê²°ê³¼ íŒŒì‹±\n        if (!execResult.success) {\n            logger.error('Python execution failed:', execResult.error);\n            return {\n                content: [{\n                    type: 'text',\n                    text: `âŒ Python ì‹¤í–‰ ì‹¤íŒ¨\\\n\\\nì—ëŸ¬: ${execResult.error || 'Unknown error'}\\\n\\\n${execResult.stderr || ''}`\n                }]\n            };\n        }\n\n        // stdoutì—ì„œ JSON ê²°ê³¼ ì¶”ì¶œ\n        let result: FlowProjectResult;\n        try {\n            // stdoutì—ì„œ JSON ë¶€ë¶„ë§Œ ì¶”ì¶œ (ë§ˆì§€ë§‰ ì™„ì „í•œ JSON ê°ì²´)\n            const stdout = execResult.stdout || '';\n            const jsonMatch = stdout.match(/\\{[^{}]*\"success\"[\\s\\S]*\\}(?!.*\\{[^{}]*\"success\")/);\n\n            if (jsonMatch) {\n                result = JSON.parse(jsonMatch[0]);\n            } else {\n                throw new Error('No valid JSON found in output');\n            }\n        } catch (parseError) {\n            logger.error('Failed to parse result:', parseError);\n            return {\n                content: [{\n                    type: 'text',\n                    text: `âŒ ê²°ê³¼ íŒŒì‹± ì‹¤íŒ¨\\\n\\\nì¶œë ¥:\\\n${execResult.stdout}\\\n\\\nì—ëŸ¬:\\\n${execResult.stderr}`\n                }]\n            };\n        }\n\n        // ê²°ê³¼ ì²˜ë¦¬\n        if (!result.success) {\n            logger.error('Flow project failed:', result.error);\n            return {\n                content: [{\n                    type: 'text',\n                    text: `âŒ í”„ë¡œì íŠ¸ ì „í™˜ ì‹¤íŒ¨: ${params.project_name}\\\n\\\nì—ëŸ¬: ${result.error}\\\n\\\n${result.details?.traceback ? '\\\nìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤:\\\n' + result.details.traceback : ''}`\n                }]\n            };\n        }\n\n        // ì„±ê³µ ì‘ë‹µ\n        const successMessage = `âœ… í”„ë¡œì íŠ¸ ì „í™˜ ì„±ê³µ: ${result.project_name}\\\n\\\n` +\n            `ğŸ“ ê²½ë¡œ: ${result.path || 'Unknown'}\\\n` +\n            `ğŸŒ¿ Git ë¸Œëœì¹˜: ${result.git_branch || 'Unknown'}\\\n`;\n\n        const workflowInfo = result.workflow_status?.plan ? \n            `\\\nğŸ“‹ í™œì„± ì›Œí¬í”Œë¡œìš°: ${result.workflow_status.plan.name}\\\n` +\n            `   ì§„í–‰ë¥ : ${result.workflow_status.plan.progress || '0/0'}` : \n            '\\\nâš ï¸ í™œì„± ì›Œí¬í”Œë¡œìš° ì—†ìŒ';\n\n        return {\n            content: [{\n                type: 'text',\n                text: successMessage + workflowInfo\n            }]\n        };\n\n    } catch (error) {\n        logger.error('handleFlowProject error:', error);\n        return {\n            content: [{\n                type: 'text',\n                text: `âŒ í•¸ë“¤ëŸ¬ ì˜¤ë¥˜\\\n\\\n${error instanceof Error ? error.message : String(error)}`\n            }]\n        };\n    }\n}\n\n// ê¸°íƒ€ ì›Œí¬í”Œë¡œìš° ê´€ë ¨ í•¸ë“¤ëŸ¬ë“¤...\n"