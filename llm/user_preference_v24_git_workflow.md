# Git 워크플로우

## Task ID: o3_task_0004
## 생성일: 2025-07-20 19:08:15

{'answer': '아래 내용은 “사람\u2006＋\u2006AI 코딩 환경”을 가정한, 실험-중심 개발에 최적화된 Git 운용 매뉴얼입니다. 예시는 모두 로컬 저장소 기준(원격 = origin)이며, 필요 시 조직 룰에 맞게 조정하면 됩니다.\n\n────────────────────────────────────────\n1. AI 어시스턴트와 협업할 때의 Git 워크플로우\n────────────────────────────────────────\nSTEP 0. 규칙\n- main (혹은 master) : 언제나 배포 가능한 상태만 유지\n- dev                 : 인간·AI가 통합 테스트를 돌리는 통합 브랜치\n- 작업용 브랜치       : AI에게 “이 기능 만들어 줘”라고 요청할 때마다 1개 생성\n  ‑ 실험(experiment)  ‑ 기능(feature)  ‑ 버그픽스(bugfix) 3계열만 허용\n\nSTEP 1. “대화” 단위로 커밋  \n1) 프롬프트를 던져 AI가 수정 제안(또는 diff)을 반환  \n2) 사용자 확인 → OK면 파일 반영  \n3) 매우 작은 단위로 stage → commit  \n   • 커밋 메시지 헤더에 AI 프롬프트 해시 또는 대화 ID를 넣어 출처 추적 가능\n\nSTEP 2. 테스트 & 자동 퀵롤백  \n- 커밋 직후 로컬 테스트 실패 →  \n  a) git revert HEAD  (결과 유지-되돌림)  \n  b) git switch ‑-detach HEAD~, 분석 → 새 브랜치 → 재시도  \n\nSTEP 3. 통합  \n- dev로 PR(또는 merge)  \n- CI 통과 → main으로 fast-forward 머지  \n- 실패 실험 브랜치는 자동 태그 후 보존(삭제 X)\n\nTIP  \n• REPL 세션 중 “wip(작업중) 스냅샷”은 임시 커밋 후 push 하지 말고 git stash ‑-include-untracked 이용  \n• AI가 만들어준 코드 블록은 git apply ‑-reject  로 패치로 받아 리뷰-적용\n\n────────────────────────────────────────\n2. 브랜치 네이밍 컨벤션\n────────────────────────────────────────\n규칙: <type>/<author>/<ticket|date>-<slug>\n\ntype       : feat | bugfix | exp(실험) | chore | doc  \nauthor     : ghID·사내ID·bot 등  \nticket|date: JIRA번호나 YYYYMMDD 형태  \nslug       : 케멀케이스·짧은 설명\n\n예)  \nfeat/jiwon/PROJ-1234-oauth-login  \nbugfix/bot/20240602-index-out-of-range  \nexp/jiwon/20240603-rewrite-parser-with-llm\n\n정규식 예) ^(feat|bugfix|exp|chore|doc)/[a-z0-9_\\-]+/[A-Z0-9\\-]+-[a-z0-9_\\-]+$\n\n────────────────────────────────────────\n3. 커밋 메시지 작성 가이드 (Conventional Commits 확장)\n────────────────────────────────────────\n헤더    : <type>[!]: <subject> [#ticket] [@AI]  \n본문(BODY)\n  • “무엇을, 왜” (어떤 프롬프트 결과인지 기술)  \n  • 브레이킹 체인지나 TODO 명확히  \n꼬리(FOOTER)\n  • 관련 이슈 Close/Fix #123  \n  • Signed-off-by, Co-authored-by 등\n\nTYPE 목록  \nfeat   : 새로운 기능  \nfix    : 버그 수정  \nrefactor : 리팩터링  \ntest   : 테스트 코드  \ndocs   : 문서  \nexp    : 실험적 변경 (성공/실패 불문)  \nrevert : git revert 자동생성  \nwip    : 절대 push 금지 임시 스냅\n\n예시)  \nexp: attempt faster dijkstra with heapq @AI\n\nPrompt-ID: 45b1e31\n- AI suggestion: replace custom heap with heapq\n- Benchmarks slowed down; will investigate\n\n────────────────────────────────────────\n4. 실패한 실험(Dead End) 기록 방법\n────────────────────────────────────────\n권장 절차  \n1) 브랜치 이름이 exp/… 라면 절대 force-push 하지 말 것  \n2) “실험 실패” 시 커밋\n   exp!: mark attempt as failed – regression x1.4\n3) 브랜치 종결 스크립트 실행\n\n# scripts/close_exp.sh\ngit tag exp-failed/$(git rev-parse --abbrev-ref HEAD)\ngit push origin $(git rev-parse --abbrev-ref HEAD) --tags\ngit switch dev           # 메인 작업 복귀\n# 옵션: git worktree prune, 브랜치 삭제는 나중 일괄 정리\n\n추가 기록 수단  \n• git notes add ‑m "WHY_FAILED: memory leak not fixed" <commit>  \n• README_experiments.md 에 요약 테이블 유지\n\n장점:  \n- commit tree는 깨끗(메인선은 revert 흔적 無)  \n- tag 또는 notes 로 나중에 검색/리플레이 가능\n\n────────────────────────────────────────\n5. 자동화 가능한 Git 명령어/alias 세트\n────────────────────────────────────────\n# ~/.gitconfig (抜粋)\n[alias]\n  sprout = "!f() { git switch -c \\"$1\\" && git push -u origin \\"$1\\"; }; f"\n  wip    = "!git add -A && git commit -m \\"wip: snapshot $(date +%s)\\""\n  unwip  = "reset --soft HEAD~1"\n  review = "!git add -p && git commit"\n  fixup  = "!git commit --fixup"\n  squash = "!git rebase -i --autosquash"\n  close-exp = "!sh scripts/close_exp.sh"\n\n실제 시나리오별 단축 예\n\nA. 모듈 수정 → 오류 → 롤백 → 재시도\ngit sprout exp/jiwon/20240605-cache-opt\n## AI 코드 적용\ngit review                # 부분 스테이지 커밋\npytest\n# 실패!\ngit revert HEAD           # 실패 흔적 남김\ngit fixup HEAD~1          # AI 수정 재적용 커밋\ngit squash                # 성공 시 revert + fixup 합치기\n\nB. 여러 파일 동시 수정\ngit add -p                # hunk 별 선택\ngit commit -m "feat: add bulk upload API @AI"\n\nC. REPL 실시간 수정\nipython ↔ 에디터 왔다갔다\nalias repl-save=\'git wip\'\nalias repl-restore=\'git unwip\'\n\n────────────────────────────────────────\n마무리 체크리스트\n[ ] AI 프롬프트마다 별도 커밋/주석 남기기  \n[ ] 실험 브랜치는 exp/ 접두어, 실패하면 tag exp-failed/...  \n[ ] wip 커밋은 원격 push 금지 (pre-push hook 권장)  \n[ ] squash & merge 전 Conventional Commit 통일  \n[ ] git notes 로 결과·메트릭 기록해 검색성 확보\n\n이와 같이만 지켜도\n① 백업 폴더가 불필요해지고  \n② 실험/롤백 이력 추적이 명확해지며  \n③ AI가 만들어내는 대량 Diff 도 안전하게 관리할 수 있습니다.', 'reasoning_effort': 'medium', 'thinking_time': 'N/A', 'usage': {'prompt_tokens': 168, 'completion_tokens': 2166, 'total_tokens': 2334, 'reasoning_tokens': 0}}
