/**
 * AI Coding Brain MCP - Tool Definitions v7.0
 * JSON REPL Session í™˜ê²½ ê¸°ë°˜ ë„êµ¬ ì •ì˜
 * 
 * ìµœìš°ì„  ì›ì¹™: helpers ê°ì²´ë¥¼ í†µí•œ ëª¨ë“  ì‘ì—… ìˆ˜í–‰
 * ì‘ì„±ì¼: 2025-06-15
 */

import { ToolDefinition } from '../types/tool-types';

export const toolDefinitions: ToolDefinition[] = [
    {
        name: 'execute_code',
        description: `ğŸ§  AI Coding Brain v7.0 - JSON REPL Session í™˜ê²½

## âš ï¸ ìµœìš°ì„  ì›ì¹™: helpers ê°ì²´ ì‚¬ìš©

execute_code ì‹¤í–‰ ì‹œ ì´ë¯¸ ì„¤ì •ëœ í™˜ê²½:

### ğŸš€ ìë™ ë¡œë“œëœ ê°ì²´
- **helpers** (AIHelpers ì¸ìŠ¤í„´ìŠ¤) - ëª¨ë“  í—¬í¼ í•¨ìˆ˜ í¬í•¨
- **context** (í˜„ì¬ í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸)
- **ê¸°ë³¸ ëª¨ë“ˆë“¤** (os, sys, np, pd ë“±)

### ğŸ“‹ ì‚¬ìš© ê°€ëŠ¥í•œ í—¬í¼ í•¨ìˆ˜ë“¤ (ì´ 28ê°œ)

**ì»¨í…ìŠ¤íŠ¸ ê´€ë¦¬ (9ê°œ):**
\`\`\`python
helpers.cmd_flow()           # í”„ë¡œì íŠ¸ ì „í™˜
helpers.initialize_context() # ì»¨í…ìŠ¤íŠ¸ ì´ˆê¸°í™”
helpers.save_context()       # ìƒíƒœ ì €ì¥
helpers.update_cache()       # ìºì‹œ ì—…ë°ì´íŠ¸
helpers.get_value()          # ê°’ ì¡°íšŒ
helpers.find_symbol()        # ì‹¬ë³¼ ê²€ìƒ‰
helpers.track_file_access()  # íŒŒì¼ ì ‘ê·¼ ì¶”ì 
helpers.track_function_edit()# í•¨ìˆ˜ ìˆ˜ì • ì¶”ì 
helpers.get_work_tracking_summary() # ì‘ì—… ìš”ì•½
\`\`\`

**ì‘ì—… ê´€ë¦¬ (3ê°œ):**
\`\`\`python
helpers.cmd_plan()   # ê³„íš ìˆ˜ë¦½
helpers.cmd_task()   # ì‘ì—… ê´€ë¦¬
helpers.cmd_next()   # ë‹¤ìŒ ì‘ì—… ì§„í–‰
\`\`\`

**íŒŒì¼ ì‘ì—… (6ê°œ):**
\`\`\`python
helpers.create_file()   # íŒŒì¼ ìƒì„±
helpers.read_file()     # íŒŒì¼ ì½ê¸°
helpers.backup_file()   # ë°±ì—… ìƒì„±
helpers.restore_backup()# ë°±ì—… ë³µì›
helpers.replace_block() # ë¸”ë¡ êµì²´
helpers.insert_block()  # ë¸”ë¡ ì‚½ì…
\`\`\`

**ì½”ë“œ ë¶„ì„ (2ê°œ):**
\`\`\`python
helpers.parse_with_snippets()  # AST íŒŒì‹±
helpers.get_snippet_preview()  # ì½”ë“œ ë¯¸ë¦¬ë³´ê¸°
\`\`\`

**ê²€ìƒ‰ (6ê°œ):**
\`\`\`python
helpers.scan_directory()      # ë””ë ‰í† ë¦¬ ìŠ¤ìº”
helpers.search_files()        # íŒŒì¼ ê²€ìƒ‰
helpers.search_code()         # ì½”ë“œ ê²€ìƒ‰
helpers.integrated_search()   # í†µí•© ê²€ìƒ‰
helpers.search_by_date()      # ë‚ ì§œë³„ ê²€ìƒ‰
helpers.search_by_file()      # íŒŒì¼ë³„ ê²€ìƒ‰
\`\`\`

## âŒ í•˜ì§€ ë§ì•„ì•¼ í•  ê²ƒ:
- initialize_context()ë¥¼ ì§ì ‘ í˜¸ì¶œ (helpers.initialize_context() ì‚¬ìš©)
- í—¬í¼ í•¨ìˆ˜ë¥¼ import ì‹œë„
- sys.path ìˆ˜ë™ ì¡°ì‘
- ì „ì—­ í•¨ìˆ˜ë¡œ ì§ì ‘ í˜¸ì¶œ

## âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš©ë²•:
\`\`\`python
# í”„ë¡œì íŠ¸ ì „í™˜
helpers.cmd_flow("my-project")

# íŒŒì¼ ì½ê¸°
content = helpers.read_file("app.py")

# ë°±ì—… ìƒì„±
backup_path = helpers.backup_file("app.py", "ìˆ˜ì •_ì „")

# ì½”ë“œ ë¸”ë¡ êµì²´
result = helpers.replace_block("app.py", "old_function", new_code)

# ìƒíƒœ ì €ì¥
helpers.save_context()
\`\`\`

## ğŸ”§ ì‘ì—… ê´€ë¦¬ ì›Œí¬í”Œë¡œìš°

### ê³„íš ìˆ˜ë¦½ (/plan)
1. ê³„íš ë¶„ì„ ë° ë¸Œë¦¬í•‘ ì œì‹œ
2. ì‚¬ìš©ì ìŠ¹ì¸ ëŒ€ê¸°
3. helpers.cmd_plan() ì‹¤í–‰
4. Phaseë³„ ì‘ì—… ì¶”ê°€

### ì‘ì—… ì¶”ê°€ (/task)
1. ì‘ì—… ë‚´ìš© ë¶„ì„
2. ì¶”ê°€ ê³„íš ë¸Œë¦¬í•‘
3. ìŠ¹ì¸ í›„ helpers.cmd_task() ì‹¤í–‰

### ì‘ì—… ì§„í–‰ (/next)
1. í˜„ì¬ ì‘ì—… ì™„ë£Œ ì²˜ë¦¬
2. helpers.cmd_next() ì‹¤í–‰
3. ë‹¤ìŒ ì‘ì—… ë¸Œë¦¬í•‘

## ğŸ“Š ë‹¨ê³„ë³„ ì‹¤í–‰ê³¼ ë³´ê³ 

ëª¨ë“  ì‘ì—…ì€ ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ì§„í–‰:

### ì‘ì—… ì‹œì‘ ì „ ë¸Œë¦¬í•‘
\`\`\`
ğŸ¯ ì‘ì—…: [ì‘ì—… ID] [ì‘ì—…ëª…]
======================================

ğŸ“Œ ì‘ì—… ëª©í‘œ:
[êµ¬ì²´ì ì¸ ëª©í‘œ ì„¤ëª…]

ğŸ“ ìˆ˜ì • ì˜ˆì • íŒŒì¼:
- [íŒŒì¼1] : [ë³€ê²½ ë‚´ìš©]
- [íŒŒì¼2] : [ë³€ê²½ ë‚´ìš©]

ğŸ”§ ì£¼ìš” ë³€ê²½ì‚¬í•­:
1. [ë³€ê²½ì‚¬í•­ 1]
   - ìœ„ì¹˜: [íŒŒì¼ëª…] > [í•¨ìˆ˜/í´ë˜ìŠ¤ëª…]
   - ë‚´ìš©: [êµ¬ì²´ì  ë³€ê²½ ë‚´ìš©]

â±ï¸ ì˜ˆìƒ ì†Œìš” ì‹œê°„: [Xë¶„]

ì´ëŒ€ë¡œ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (Y/N)
\`\`\`

### ë‹¨ê³„ë³„ ì½”ë“œ ìˆ˜ì •
\`\`\`python
# 1ë‹¨ê³„: ë°±ì—… ìƒì„±
print("ğŸ” ë°±ì—… ìƒì„± ì¤‘...")
result = helpers.backup_file(file, f"ì‘ì—…_{task_id}_ì‹œì‘_ì „")

# 2ë‹¨ê³„: ìˆ˜ì • ì‹¤í–‰
print(f"ğŸ”§ ìˆ˜ì • ì‘ì—… ì§„í–‰ ({current_step}/{total_steps})")
result = helpers.replace_block(file_path, block_name, new_content)

# 3ë‹¨ê³„: ê²€ì¦
print("ğŸ” ìˆ˜ì • ê²°ê³¼ ê²€ì¦ ì¤‘...")
content = helpers.read_file(file_path)
\`\`\`

### ê²°ê³¼ ë³´ê³ 
\`\`\`
âœ… ì‘ì—… ì™„ë£Œ: [ì‘ì—…ëª…]
======================================

ğŸ“Š ìˆ˜ì • ìš”ì•½:
- ìˆ˜ì •ëœ íŒŒì¼: Xê°œ
- ë³€ê²½ëœ í•¨ìˆ˜: Yê°œ
- ì¶”ê°€ëœ ë¼ì¸: +Z
- ì‚­ì œëœ ë¼ì¸: -W

ğŸ“ ìƒì„¸ ë³€ê²½ ë‚´ì—­:
[íŒŒì¼ë³„ ìƒì„¸ ë‚´ì—­]

ğŸ§ª í…ŒìŠ¤íŠ¸ í•„ìš”:
[í…ŒìŠ¤íŠ¸ í•­ëª© ëª©ë¡]

ë‹¤ìŒ ì‘ì—…ìœ¼ë¡œ ì§„í–‰: /next
\`\`\`

## ğŸš¨ ì˜¤ë¥˜ ì²˜ë¦¬

ì˜¤ë¥˜ ë°œìƒ ì‹œ ìƒì„¸ ì •ë³´ ì œê³µ:
\`\`\`
âŒ ì˜¤ë¥˜ ë°œìƒ!
======================================

ğŸ“ ì˜¤ë¥˜ ìœ„ì¹˜:
- íŒŒì¼: [íŒŒì¼ ê²½ë¡œ]
- í•¨ìˆ˜: [í•¨ìˆ˜ëª…]
- ë¼ì¸: [ë¼ì¸ ë²ˆí˜¸]

ğŸ” ì˜¤ë¥˜ ì •ë³´:
- íƒ€ì…: [ì—ëŸ¬ íƒ€ì…]
- ë©”ì‹œì§€: [ì—ëŸ¬ ë©”ì‹œì§€]

ğŸ’¡ í•´ê²° ë°©ì•ˆ:
[êµ¬ì²´ì ì¸ í•´ê²° ë°©ë²•ë“¤]

ğŸ”§ ë³µêµ¬ ì˜µì…˜:
- ë°±ì—…ì—ì„œ ë³µì›: helpers.restore_backup(...)
- ìˆ˜ë™ ìˆ˜ì • í›„ ì¬ì‹œë„
\`\`\`

## ğŸ’¡ í•µì‹¬ ì›ì¹™
1. ëª¨ë“  ì‘ì—…ì€ íˆ¬ëª…í•˜ê²Œ ì§„í–‰ - ì‚¬ìš©ìê°€ ì •í™•íˆ ì•Œ ìˆ˜ ìˆë„ë¡
2. ì¤‘ìš” ë³€ê²½ ì „ ë°˜ë“œì‹œ ìŠ¹ì¸ - ìë™ ì§„í–‰ ê¸ˆì§€
3. í•œ ë²ˆì— í•˜ë‚˜ì”© - ë‹¨ê³„ë³„ ì§„í–‰
4. ìƒì„¸í•œ ë³´ê³  - íŒŒì¼, í•¨ìˆ˜, ë¼ì¸ ë²ˆí˜¸ê¹Œì§€
5. ì˜¤ë¥˜ ì‹œ ì •í™•í•œ ìœ„ì¹˜ì™€ í•´ê²° ë°©ì•ˆ ì œì‹œ`,
        inputSchema: {
            type: 'object',
            properties: {
                code: {
                    type: 'string',
                    description: 'Python ì½”ë“œ. helpers ê°ì²´ë¥¼ í†µí•´ ëª¨ë“  ì‘ì—… ìˆ˜í–‰.'
                },
                language: {
                    type: 'string',
                    enum: ['python', 'javascript', 'typescript'],
                    description: 'ì–¸ì–´ (ê¸°ë³¸ê°’: python)',
                    default: 'python'
                }
            },
            required: ['code']
        }
    },
    {
        name: 'restart_json_repl',
        description: `ğŸ”„ JSON REPL ì„¸ì…˜ ì¬ì‹œì‘

## ëª©ì 
- ë³€ìˆ˜ ì •ë¦¬ ë° ë©”ëª¨ë¦¬ ìµœì í™”
- ì„¸ì…˜ ì´ˆê¸°í™”
- helpers ê°ì²´ëŠ” ìœ ì§€ ê°€ëŠ¥

## ì‚¬ìš© ì‹œì 
- ë©”ëª¨ë¦¬ ê³¼ë‹¤ ì‚¬ìš© ì‹œ
- ë³€ìˆ˜ ì¶©ëŒ ë°œìƒ ì‹œ
- ê¹¨ë—í•œ í™˜ê²½ì—ì„œ ì‹œì‘í•˜ê³  ì‹¶ì„ ë•Œ

## ì‚¬ìš©ë²•
\`\`\`python
# helpers ìœ ì§€í•˜ë©° ì¬ì‹œì‘ (ê¸°ë³¸ê°’)
restart_json_repl()

# ì™„ì „ ì´ˆê¸°í™”
restart_json_repl(keep_helpers=False)

# ì´ìœ  ëª…ì‹œ
restart_json_repl(reason="ë©”ëª¨ë¦¬ ì •ë¦¬")
\`\`\`

## ì£¼ì˜ì‚¬í•­
- ëª¨ë“  ì‚¬ìš©ì ë³€ìˆ˜ ì‚­ì œë¨
- keep_helpers=Falseë©´ helpersë„ ì¬ë¡œë“œ í•„ìš”
- ì‹¤í–‰ ì¤‘ì¸ ì‘ì—…ì€ ì™„ë£Œ í›„ ì‚¬ìš©`,
        inputSchema: {
            type: 'object',
            properties: {
                reason: {
                    type: 'string',
                    description: 'ì¬ì‹œì‘ ì´ìœ ',
                    default: 'ì„¸ì…˜ ìƒˆë¡œê³ ì¹¨'
                },
                keep_helpers: {
                    type: 'boolean',
                    description: 'helpers ê°ì²´ ìœ ì§€ ì—¬ë¶€',
                    default: true
                }
            },
            required: []
        }
    },
    {
        name: 'backup_file',
        description: `ğŸ—‚ï¸ íŒŒì¼ ë°±ì—… ìƒì„± (helpers.backup_file ì‚¬ìš©)

## ì‚¬ìš©ë²•
\`\`\`python
# execute_code í™˜ê²½ì—ì„œ ì‚¬ìš©
backup_path = helpers.backup_file("app.py", "ìˆ˜ì •_ì „")
print(f"ë°±ì—… ìƒì„±ë¨: {backup_path}")
\`\`\`

## ë°±ì—… êµ¬ì¡°
\`\`\`
í”„ë¡œì íŠ¸/
â””â”€â”€ backups/
    â””â”€â”€ 2025-06-15/  (ì˜¤ëŠ˜ ë‚ ì§œ)
        â”œâ”€â”€ app.py.ìˆ˜ì •_ì „.152000.bak
        â”œâ”€â”€ app.py.ë²„ê·¸_ìˆ˜ì •.152301.bak
        â””â”€â”€ app.py.ë¦¬íŒ©í† ë§.153045.bak
\`\`\`

## ì‘ì—… íë¦„
1. ìˆ˜ì • ì „ í•­ìƒ ë°±ì—…
2. ë°±ì—… ê²½ë¡œ ê¸°ë¡
3. ë¬¸ì œ ë°œìƒ ì‹œ ë³µì› ê°€ëŠ¥

## ì˜ˆì‹œ
\`\`\`python
# ì‘ì—…ë³„ ë°±ì—…
backup_path = helpers.backup_file("models.py", f"ì‘ì—…_{task_id}_ì‹œì‘_ì „")

# ìœ„í—˜í•œ ì‘ì—… ì „
backup_path = helpers.backup_file("config.json", "ëŒ€ê·œëª¨_ë³€ê²½_ì „")

# ë²„ê·¸ ìˆ˜ì • ì „
backup_path = helpers.backup_file("utils.py", "ë²„ê·¸_#123_ìˆ˜ì •_ì „")
\`\`\``,
        inputSchema: {
            type: 'object',
            properties: {
                filepath: {
                    type: 'string',
                    description: 'ë°±ì—…í•  íŒŒì¼ ê²½ë¡œ'
                },
                reason: {
                    type: 'string',
                    description: 'ë°±ì—… ì´ìœ  (íŒŒì¼ëª…ì— í¬í•¨)',
                    default: 'backup'
                }
            },
            required: ['filepath']
        }
    },
    {
        name: 'restore_backup',
        description: `ğŸ”„ ë°±ì—… íŒŒì¼ ë³µì› (helpers.restore_backup ì‚¬ìš©)

## ì‚¬ìš©ë²•
\`\`\`python
# ìë™ ê²½ë¡œ ë³µì›
result = helpers.restore_backup("backups/2025-06-15/app.py.ìˆ˜ì •_ì „.152000.bak")

# íŠ¹ì • ìœ„ì¹˜ë¡œ ë³µì›
result = helpers.restore_backup(backup_path, "app_restored.py")
\`\`\`

## ë³µì› í”„ë¡œì„¸ìŠ¤
1. ë°±ì—… íŒŒì¼ í™•ì¸
2. ì›ë³¸ ê²½ë¡œ ìë™ ì¶”ì¶œ
3. ê¸°ì¡´ íŒŒì¼ ìë™ ë°±ì—…
4. ë³µì› ì‹¤í–‰
5. ê²°ê³¼ ë³´ê³ 

## ì˜¤ë¥˜ ë³µêµ¬ ì‹œë‚˜ë¦¬ì˜¤
\`\`\`python
# ì‘ì—… ì‹¤íŒ¨ ì‹œ ë³µêµ¬
try:
    result = helpers.replace_block(file, block, new_code)
    if "ERROR" in result:
        print("âŒ ìˆ˜ì • ì‹¤íŒ¨! ë°±ì—…ì—ì„œ ë³µì› ì¤‘...")
        restore_result = helpers.restore_backup(backup_path)
        print(f"âœ… ë³µì› ì™„ë£Œ: {restore_result}")
except Exception as e:
    # ê¸´ê¸‰ ë³µì›
    helpers.restore_backup(backup_path)
\`\`\``,
        inputSchema: {
            type: 'object',
            properties: {
                backup_path: {
                    type: 'string',
                    description: 'ë³µì›í•  ë°±ì—… íŒŒì¼ ê²½ë¡œ'
                },
                targetPath: {
                    type: 'string',
                    description: 'ë³µì› ëŒ€ìƒ ê²½ë¡œ (ì„ íƒì‚¬í•­)'
                }
            },
            required: ['backup_path']
        }
    },
    {
        name: 'list_backups',
        description: `ğŸ“‹ ë°±ì—… ëª©ë¡ ì¡°íšŒ

## ì‚¬ìš©ë²•
\`\`\`python
# ëª¨ë“  ë°±ì—… ì¡°íšŒ
all_backups = list_backups()

# íŠ¹ì • íŒŒì¼ì˜ ë°±ì—…ë§Œ ì¡°íšŒ
app_backups = list_backups("app.py")
\`\`\`

## ê²°ê³¼ í˜•ì‹
\`\`\`python
{
    'backups': [
        {
            'file': 'app.py',
            'reason': 'ìˆ˜ì •_ì „',
            'timestamp': '152000',
            'date': '2025-06-15',
            'path': 'backups/2025-06-15/app.py.ìˆ˜ì •_ì „.152000.bak'
        }
    ],
    'total': 5
}
\`\`\``,
        inputSchema: {
            type: 'object',
            properties: {
                filename: {
                    type: 'string',
                    description: 'í•„í„°ë§í•  íŒŒì¼ëª… (ì„ íƒì‚¬í•­)'
                }
            },
            required: []
        }
    }
];