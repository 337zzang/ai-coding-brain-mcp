/**
 * AI Coding Brain MCP - Tool Definitions
 * execute_code ë„êµ¬ ì •ì˜ - ì™„ì „ ê°€ì´ë“œ
 * 
 * TypeScript í…œí”Œë¦¿ ë¦¬í„°ëŸ´ ë³€í™˜ ê°€ì´ë“œ:
 * - ì‘ì€ë”°ì˜´í‘œ â†’ ë°±í‹±: 'text' â†’ `text`
 * - ë¬¸ìì—´ ì—°ê²° ì œê±°: 'a' + 'b' â†’ `ab`
 * - ì‹¤ì œ ì¤„ë°”ê¿ˆ: 'line1\\n' + 'line2' â†’ `line1\nline2`
 * - ë°±í‹± ì´ìŠ¤ì¼€ì´í•‘: \\` ì‚¬ìš©
 * - ë‹¬ëŸ¬ í‘œí˜„ì‹: \\${} ì‚¬ìš©
 * 
 * ì ìš© ìˆœì„œ: 1) + ì—°ê²° ì°¾ê¸° â†’ 2) ë”°ì˜´í‘œë¥¼ ë°±í‹±ìœ¼ë¡œ â†’ 3) ì—°ê²°ì ì œê±° â†’ 4) ì»´íŒŒì¼ í…ŒìŠ¤íŠ¸
 */

export const toolDefinitions = [
    {
        name: 'execute_code',
        description: `ğŸ§  AI Coding Brain - ì§€ëŠ¥í˜• ì—°ì† ê°œë°œ í™˜ê²½

## ğŸ¯ í•µì‹¬ íŠ¹ì§•: 24ê°œ ê²€ì¦ëœ í—¬í¼ í•¨ìˆ˜ + ì§€ì†ì  ì„¸ì…˜ + Tree-sitter íŒŒì‹±

### âš¡ ì—°ì† ì„¸ì…˜ì˜ í•µì‹¬ ê°€ì¹˜: ìƒíƒœ ìœ ì§€ + ì»¨í…ìŠ¤íŠ¸ ëˆ„ì 

\`\`\`python
# ì„¸ì…˜ ë³€ìˆ˜ê°€ ê³„ì† ìœ ì§€ë˜ì–´ íš¨ìœ¨ì  ë°˜ë³µ ì‘ì—… ê°€ëŠ¥
project_context = {
    'files': [], 'analysis_cache': {}, 'backup_history': [],
    'feedback_history': [], 'modification_log': []
}

# Tree-sitter ê¸°ë°˜ ê³ ì„±ëŠ¥ íŒŒì‹±ìœ¼ë¡œ ì •í™•ë„ 1200% í–¥ìƒ
import ast_parser_helpers
result = ast_parser_helpers.parse_with_snippets(file_path, 'typescript')
project_context['analysis_cache'][file_path] = result  # ìºì‹œë¡œ ì¬ì‚¬ìš©
\`\`\`

## ğŸ”§ 24ê°œ ê²€ì¦ëœ í—¬í¼ í•¨ìˆ˜ ì „ì²´ ëª©ë¡

### ğŸ“ íŒŒì¼ ì‹œìŠ¤í…œ (6ê°œ) - ê¸°ë³¸ ì¤‘ì˜ ê¸°ë³¸
- **create_file(filepath, content)**: UTF-8 í•œê¸€ ì§€ì› íŒŒì¼ ìƒì„±
- **read_file(filepath)**: ìë™ ì¸ì½”ë”© íŒŒì¼ ì½ê¸°
- **backup_file(filepath, reason)**: íƒ€ì„ìŠ¤íƒ¬í”„ ë°±ì—… ìƒì„± (ë³µì›ì  í™•ë³´)
- **restore_backup(backup_path)**: ë°±ì—…ì—ì„œ ì•ˆì „ ë³µì›
- **create_file_backup_manual(filepath, reason)**: ìˆ˜ë™ ë°±ì—…
- **safe_delete_files(files, category, backup=True)**: ë°±ì—… í›„ ì•ˆì „ ì‚­ì œ

### ğŸ§  AST ë¶„ì„ (3ê°œ) - Tree-sitter ê¸°ë°˜ ê³ ì„±ëŠ¥
- **parse_with_snippets(filepath, language)**: Tree-sitter ì „ìš© Python/JS/TS ì™„ì „ íŒŒì‹±
  - âœ… **ì •í™•ë„**: ì •ê·œì‹ ëŒ€ë¹„ 1200% í–¥ìƒ (ë©”ì„œë“œ 1ê°œâ†’12ê°œ ê°ì§€)
  - âœ… **íŒŒì‹± ì„±ê³µë¥ **: parsing_success=True í”Œë˜ê·¸ ì§€ì›
  - âœ… **ì–¸ì–´ ì§€ì›**: Python(ast), JavaScript/TypeScript(Tree-sitter)
- **analyze_coding_context(result, error_info, tech_stack)**: ì½”ë“œ ì»¨í…ìŠ¤íŠ¸ ë¶„ì„
- **analyze_safe_deletions()**: ì•ˆì „ ì‚­ì œ ì˜í–¥ë„ ë¶„ì„

### âœï¸ í…ìŠ¤íŠ¸ ì¡°ì‘ (3ê°œ) - ê²€ì¦ëœ 100% ì„±ê³µë¥ 

#### 1ï¸âƒ£ safe_replace() - ì •í™•í•œ í…ìŠ¤íŠ¸ êµì²´
**âœ… ì„±ê³µë¥ : ê¸°ë³¸ í…ìŠ¤íŠ¸ ìˆ˜ì • 100%, êµ¬ì¡°ì  ìˆ˜ì • 100%, ë³µì¡í•œ ë¦¬íŒ©í† ë§ 50%**

\`\`\`python
# ğŸŸ¢ ê¶Œì¥ ì‚¬ìš© ë²”ìœ„ (100% ì„±ê³µ ë³´ì¥)
safe_replace('app.js', 'oldFunctionName', 'newFunctionName')        # í•¨ìˆ˜ëª… ë³€ê²½
safe_replace('config.py', 'DEBUG = True', 'DEBUG = False')          # ì„¤ì •ê°’ ë³€ê²½
safe_replace('api.ts', 'https://old-api.com', 'https://new-api.com') # URL ë³€ê²½
safe_replace('models.py', 'old_variable', 'new_variable')           # ë³€ìˆ˜ëª… ë³€ê²½

# ğŸŸ¡ ì£¼ì˜ ì‚¬ìš© (ë¶€ë¶„ì  ì„±ê³µ)
safe_replace('complex.js', 'old_method()', 'new_method()')          # ì‹œê·¸ë‹ˆì²˜ ë³€ê²½
\`\`\`

**ğŸ“‹ ì‚¬ìš© ê°€ì´ë“œ:**
- ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì •í™•í•œ ë§¤ì¹­ | ì „ì²´ ë‹¨ì–´ ë§¤ì¹­ ì¶”ì²œ
- ë‹¨ìˆœ í…ìŠ¤íŠ¸ êµì²´ì— ìµœì í™” | ë°±ì—… ê¶Œì¥ (ì¤‘ìš”í•œ íŒŒì¼)

#### 2ï¸âƒ£ insert_line() - ìœ„ì¹˜ë³„ ë¼ì¸ ì‚½ì…
**âœ… ì„±ê³µë¥ : 100% (ì˜¬ë°”ë¥¸ target ì§€ì •ì‹œ)**

\`\`\`python
# í´ë˜ìŠ¤ì— ìƒˆ ë©”ì„œë“œ ì¶”ê°€
new_method = """    async getUserCount() {
        return this.users.size;
    }"""
insert_line('UserManager.js', new_method, target='UserManager', target_type='class')

# ì¸í„°í˜ì´ìŠ¤ì— í”„ë¡œí¼í‹° ì¶”ê°€
insert_line('types.ts', '    role: string;', target='User {', target_type='after')

# import êµ¬ë¬¸ ì¶”ê°€
insert_line('app.js', 'import axios from "axios";', target='import', target_type='after')
\`\`\`

#### 3ï¸âƒ£ delete_lines() v2.0 Enhanced - íŒ¨í„´ ê¸°ë°˜ ì‚­ì œ
**âœ… ì„±ê³µë¥ : 100% (íŒ¨í„´ ê¸°ë°˜ ì‚­ì œì‹œ) - ë¼ì¸ ë²ˆí˜¸ ë³€í™” ë¬¸ì œ ì™„ì „ í•´ê²°**

\`\`\`python
# ğŸ¯ ìµœê³  ê¶Œì¥: íŒ¨í„´ ê¸°ë°˜ ì‚­ì œ
delete_lines('app.js', pattern='generateId')              # í•¨ìˆ˜ëª…ìœ¼ë¡œ ì‚­ì œ
delete_lines('types.ts', pattern='interface OldInterface') # ì¸í„°í˜ì´ìŠ¤ ì‚­ì œ
delete_lines('config.py', pattern='# TODO.*deprecated')   # ì •ê·œì‹ íŒ¨í„´

# ğŸ¯ ì •í™•í•œ ë‚´ìš© ë§¤ì¹­ ì‚­ì œ
exact_method = """    validateUser(data) {
        return data.isValid;
    }"""
delete_lines('validator.js', content_match=exact_method)

# ğŸ›¡ï¸ ì•ˆì „ ëª¨ë“œ ì˜µì…˜
delete_lines('critical.js', pattern='oldFunction', safe_mode=True)   # ì‚­ì œ ì „ í™•ì¸
\`\`\`

### ğŸ§  Claude ë©”ëª¨ë¦¬ (6ê°œ) - ê°œë°œ ê²½í—˜ í•™ìŠµ
- **save_coding_experience(data, project_context, tech_stack)**: ê°œë°œ ê²½í—˜ ìë™ ì €ì¥
- **search_coding_solutions(query, project_context, tech_stack)**: ê³¼ê±° í•´ê²°ì±… ê²€ìƒ‰
- **get_coding_insights(project_context, tech_stack, time_range)**: í”„ë¡œì íŠ¸ë³„ ì¸ì‚¬ì´íŠ¸
- **get_claude_memory()**: Claude Memory ì§ì ‘ ì ‘ê·¼
- **cleanup_coding_memory(dry_run, max_age, min_importance)**: ë©”ëª¨ë¦¬ ìµœì í™”
- **analyze_coding_context(result, error_info, tech_stack, project_context)**: ì»¨í…ìŠ¤íŠ¸ ë¶„ì„

### ğŸ› ï¸ ìœ í‹¸ë¦¬í‹° (6ê°œ) - ê°œë°œ ì§€ì› ë„êµ¬
- **check_dependencies(deps)**: ì˜ì¡´ì„± í™•ì¸
- **get_snippet_preview(filepath, element_name, element_type)**: ì½”ë“œ ìŠ¤ë‹ˆí« ë¯¸ë¦¬ë³´ê¸°
- **import_module_safely(module_info)**: ì•ˆì „í•œ ëª¨ë“ˆ ì„í¬íŠ¸
- **register_all_helpers()**: í—¬í¼ í•¨ìˆ˜ ê¸€ë¡œë²Œ ë“±ë¡
- **safe_print(data, max_length, max_items)**: ì•ˆì „í•œ ëŒ€ìš©ëŸ‰ ì¶œë ¥
- **scan_directory(path, level)**: ë””ë ‰í† ë¦¬ ì¬ê·€ ìŠ¤ìº”

## ğŸ’¡ í•µì‹¬ ì‚¬ìš© ì›ì¹™ (User Preferences ê¸°ë°˜)

### âœ… ê²€ì¦ëœ í—¬í¼ í•¨ìˆ˜ ìš°ì„  ì‚¬ìš© ì›ì¹™
**âŒ ì˜ëª»ëœ ë°©ì‹:** execute_code ë‚´ë¶€ì—ì„œ ì„ì‹œ í•¨ìˆ˜ ì •ì˜
\`\`\`python
def parse_with_snippets(filepath):  # ì„ì‹œ ì •ê·œì‹ êµ¬í˜„ - ë¶€ì •í™•
    # ì •ê·œì‹ ê¸°ë°˜ íŒŒì‹±... ë©”ì„œë“œ 1ê°œë§Œ ê°ì§€
\`\`\`

**âœ… ì˜¬ë°”ë¥¸ ë°©ì‹:** ê¸°ì¡´ ê²€ì¦ëœ í—¬í¼ í•¨ìˆ˜ ì§ì ‘ ì‚¬ìš©
\`\`\`python
import ast_parser_helpers
result = ast_parser_helpers.parse_with_snippets(file_path, language)  # Tree-sitter: ë©”ì„œë“œ 12ê°œ ê°ì§€
\`\`\`

## ğŸš€ ì‹¤ì œ í”„ë¡œì íŠ¸ í™œìš© íŒ¨í„´

### ğŸ“‹ ì‹ ê·œ í”„ë¡œì íŠ¸ ìƒì„± ì›Œí¬í”Œë¡œ
\`\`\`python
# 1. í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸ ì´ˆê¸°í™”
project_context = {'name': 'ìƒˆí”„ë¡œì íŠ¸', 'analyzed_files': {}, 'backup_history': []}

# 2. í•µì‹¬ íŒŒì¼ ìƒì„±
create_file("app.py", "from flask import Flask\napp = Flask(__name__)")
create_file("models.py", "# ëª¨ë¸ ì •ì˜\nclass User:\n    pass")
create_file("requirements.txt", "flask==2.0.1")

# 3. êµ¬ì¡° ë¶„ì„ ë° ìºì‹œ
for file_path in ['app.py', 'models.py']:
    analysis = ast_parser_helpers.parse_with_snippets(file_path)
    project_context['analyzed_files'][file_path] = analysis
\`\`\`

### ğŸ”„ ì•ˆì „í•œ ë¦¬íŒ©í† ë§ ì‚¬ì´í´
\`\`\`python
# 1. ë°±ì—… ìƒì„± (ë³µì›ì  í™•ë³´)
backup_file("models.py", "ë¦¬íŒ©í† ë§ ì‹œì‘ ì „ ë°±ì—…")

# 2. ìˆœì„œëŒ€ë¡œ ìˆ˜ì • (ì‚­ì œ â†’ êµì²´ â†’ ì¶”ê°€)
delete_lines("models.py", pattern="old_method")     # ê¸°ì¡´ ë©”ì„œë“œ ì œê±°
safe_replace("models.py", "old_variable", "new_variable")  # ë³€ìˆ˜ëª… í†µì¼
insert_line("models.py", "    # ìƒˆë¡œìš´ ë©”ì„œë“œ", target="class User", target_type="after")

# 3. ê°œë°œ ê²½í—˜ ì €ì¥
save_coding_experience({
    "task": "Django ëª¨ë¸ ë¦¬íŒ©í† ë§",
    "solution": "ë°±ì—… â†’ ì‚­ì œ â†’ êµì²´ â†’ ì¶”ê°€ ìˆœì„œë¡œ ì•ˆì „ ì§„í–‰",
    "importance": 0.9
})
\`\`\`

## âš ï¸ Windows ì¸ì½”ë”© í˜¸í™˜ì„± ê°€ì´ë“œ

### Windows cp949 ì¸ì½”ë”© ì œí•œì‚¬í•­
Windows í•œêµ­ì–´ í™˜ê²½ì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ cp949(EUC-KR) ì¸ì½”ë”©ì„ ì‚¬ìš©í•˜ë©°, ë‹¤ìŒê³¼ ê°™ì€ ì œí•œì´ ìˆìŠµë‹ˆë‹¤:

**âœ… ì§€ì›ë˜ëŠ” ë¬¸ì:**
- ASCII ë¬¸ì (0-127): ì˜ì–´, ìˆ«ì, ê¸°ë³¸ ê¸°í˜¸
- í•œê¸€ ë¬¸ì: ì™„ì„±í˜• í•œê¸€
- ì¼ë¶€ íŠ¹ìˆ˜ë¬¸ì: !@#$%^&*()_+-=[]{}|;:,.<>?

**âŒ ì§€ì›ë˜ì§€ ì•ŠëŠ” ë¬¸ì:**
- ì´ëª¨ì§€: ğŸ¯ğŸ“‹âœ…âŒğŸ”§ğŸ’¡âš ï¸ğŸš€ğŸ“Š ë“±
- ìœ ë‹ˆì½”ë“œ íŠ¹ìˆ˜ë¬¸ì: âœ“âœ—â†’â†â†‘â†“â€» ë“±

### ğŸ”§ ì¸ì½”ë”© ì•ˆì „ ê°€ì´ë“œë¼ì¸

1. **ì½˜ì†” ì¶œë ¥ì‹œ ASCII ë¬¸ì ì‚¬ìš©**
   \`\`\`python
   # âŒ ë¬¸ì œê°€ ë˜ëŠ” ì½”ë“œ
   print("ğŸ¯ ì‘ì—… ì‹œì‘")     # UnicodeEncodeError
   
   # âœ… ì•ˆì „í•œ ì½”ë“œ
   print("TARGET: ì‘ì—… ì‹œì‘")  # ì •ìƒ ì‘ë™
   \`\`\`

2. **ìƒíƒœ í‘œì‹œëŠ” ì˜ì–´ í…ìŠ¤íŠ¸ë¡œ**
   - "SUCCESS: ì™„ë£Œ", "ERROR: ì‹¤íŒ¨", "INFO: ì²˜ë¦¬ì¤‘..."

3. **f-string ë‚´ ë°±ìŠ¬ë˜ì‹œ ì‚¬ìš© ê¸ˆì§€**
   \`\`\`python
   # âŒ f-string ì•ˆì—ì„œ ë°±ìŠ¬ë˜ì‹œ ë¶ˆê°€
   print(f"íŒŒì¼ëª…: {filename.replace('\\', '/')}")
   
   # âœ… ë°±ìŠ¬ë˜ì‹œë¥¼ ë³€ìˆ˜ë¡œ ë¶„ë¦¬
   separator = '/'
   print(f"íŒŒì¼ëª…: {filename.replace('\\', separator)}")
   \`\`\`


ì´ ë„êµ¬ëŠ” **24ê°œ ê²€ì¦ëœ í—¬í¼ í•¨ìˆ˜**ì™€ **Tree-sitter ê¸°ë°˜ ê³ ì„±ëŠ¥ íŒŒì‹±**, **ì—°ì† ì„¸ì…˜ ìƒíƒœ ìœ ì§€**ë¥¼ í™œìš©í•´ ì§€ëŠ¥ì ì´ê³  íš¨ìœ¨ì ì¸ ê°œë°œ í™˜ê²½ì„ ì œê³µí•©ë‹ˆë‹¤. ê¸°ì¡´ í—¬í¼ í•¨ìˆ˜ë¥¼ ìš°ì„  ì‚¬ìš©í•˜ì—¬ ì •í™•ë„ì™€ ì‹ ë¢°ì„±ì„ ë³´ì¥í•˜ë©°, ì‚¬ìš©ì í”¼ë“œë°± ê¸°ë°˜ìœ¼ë¡œ ì§€ì†ì ìœ¼ë¡œ ê°œì„ ë©ë‹ˆë‹¤.`,
        inputSchema: {
            type: 'object',
            properties: {
                code: {
                    type: 'string',
                    description: 'Code to execute (Python/JavaScript/TypeScript). AI helpers auto-imported.'
                },
                language: {
                    type: 'string',
                    enum: ['python', 'javascript', 'typescript'],
                    description: 'Programming language (auto-detected if not specified)'
                }
            },
            required: ['code']
        }
    }

,
    {
        name: 'restart_session',
        description: `Execute Code ì„¸ì…˜ ì¬ì‹œì‘ ë° ë©”ëª¨ë¦¬ ì •ë¦¬

## í•µì‹¬ ê¸°ëŠ¥
- Python ê¸€ë¡œë²Œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë³€ìˆ˜ ì •ë¦¬
- ë©”ëª¨ë¦¬ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ìˆ˜í–‰  
- AI í—¬í¼í•¨ìˆ˜ ì„ íƒì  ìœ ì§€
- ì„¸ì…˜ ìƒíƒœ ì´ˆê¸°í™”

## ì‚¬ìš© ì‹œì 
- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ ê³¼ë‹¤í•  ë•Œ
- ë³€ìˆ˜ê°€ ë„ˆë¬´ ë§ì´ ëˆ„ì ë˜ì—ˆì„ ë•Œ
- ê¹¨ë—í•œ ìƒíƒœì—ì„œ ìƒˆ ì‘ì—…ì„ ì‹œì‘í•  ë•Œ
- í—¬í¼í•¨ìˆ˜ëŠ” ìœ ì§€í•˜ë©´ì„œ ì„¸ì…˜ë§Œ ì •ë¦¬í•˜ê³  ì‹¶ì„ ë•Œ

## ì£¼ì˜ì‚¬í•­
- ëª¨ë“  ì‚¬ìš©ì ì •ì˜ ë³€ìˆ˜ê°€ ì‚­ì œë©ë‹ˆë‹¤
- keep_helpers=falseì¸ ê²½ìš° í—¬í¼í•¨ìˆ˜ë„ ì‚­ì œë©ë‹ˆë‹¤
- ì‹¤í–‰ ì¤‘ì¸ ì‘ì—…ì´ ìˆë‹¤ë©´ ì™„ë£Œ í›„ ì‚¬ìš©í•˜ì„¸ìš”`,
        inputSchema: {
            type: 'object',
            properties: {
                keep_helpers: {
                    type: 'boolean',
                    description: 'AI í—¬í¼í•¨ìˆ˜ë“¤ì„ ìœ ì§€í• ì§€ ì—¬ë¶€ (ê¸°ë³¸ê°’: true)',
                    default: true
                }
            },
            required: []
        }
    }
];