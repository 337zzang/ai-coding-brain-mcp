
def cmd_flow_with_context(project_name: str = None, existing_context: Dict[str, Any] = None) -> Dict[str, Any]:
    """
    í”„ë¡œì íŠ¸ ì „í™˜ + ì»¨í…ìŠ¤íŠ¸ ìë™ ì—…ë°ì´íŠ¸ + Wisdom ë¡œë“œ
    
    v22.0 ê¸°ëŠ¥:
    - í”„ë¡œì íŠ¸ ì „í™˜ ì‹œ context ìë™ ì—…ë°ì´íŠ¸
    - Wisdom ì‹œìŠ¤í…œ ìë™ ì´ˆê¸°í™”
    - project_vision.md ìë™ ë¡œë“œ
    - execute_code í™˜ê²½ê³¼ ë™ê¸°í™”
    
    Args:
        project_name: ì „í™˜í•  í”„ë¡œì íŠ¸ëª…
        existing_context: ê¸°ì¡´ ì»¨í…ìŠ¤íŠ¸ (ì„ íƒì‚¬í•­)
        
    Returns:
        dict: í”„ë¡œì íŠ¸ ì „í™˜ ê²°ê³¼ + ì—…ë°ì´íŠ¸ëœ ì»¨í…ìŠ¤íŠ¸
    """
    
    # 1. ê¸°ë³¸ flow ì‹¤í–‰
    result = cmd_flow(project_name, existing_context)
    
    if not result.get('success'):
        return result
    
    # 2. ì»¨í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ ê°•í™”
    manager = get_context_manager()
    if manager and manager.context:
        # execute_code í™˜ê²½ì˜ ê¸€ë¡œë²Œ context ì—…ë°ì´íŠ¸
        if 'context' in globals():
            globals()['context'] = manager.context
        
        # __main__ ëª¨ë“ˆì˜ contextë„ ì—…ë°ì´íŠ¸
        try:
            import __main__
            if hasattr(__main__, 'context'):
                __main__.context = manager.context
        except:
            pass
        
        # sys.modulesì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ì„¸ì…˜ì˜ context ì—…ë°ì´íŠ¸
        for module_name, module in sys.modules.items():
            if hasattr(module, 'context') and module_name in ['__main__', 'json_repl_session']:
                module.context = manager.context
    
    # 3. Wisdom ì‹œìŠ¤í…œ ë¡œë“œ ë° ì´ˆê¸°í™”
    wisdom_loaded = False
    wisdom_stats = {}
    
    if WISDOM_AVAILABLE:
        try:
            wisdom = get_wisdom_manager()
            hooks = get_wisdom_hooks()
            
            # Wisdom í†µê³„
            wisdom_stats = {
                'common_mistakes': len(wisdom.wisdom_data.get('common_mistakes', {})),
                'error_patterns': len(wisdom.wisdom_data.get('error_patterns', {})),
                'best_practices': len(wisdom.wisdom_data.get('best_practices', {})),
                'last_updated': wisdom.wisdom_data.get('last_updated', 'Never')
            }
            
            wisdom_loaded = True
            print(f"\nğŸ§  Wisdom ì‹œìŠ¤í…œ ë¡œë“œ ì™„ë£Œ:")
            print(f"  - ì¶”ì ëœ ì‹¤ìˆ˜: {wisdom_stats['common_mistakes']}ê°œ")
            print(f"  - ì˜¤ë¥˜ íŒ¨í„´: {wisdom_stats['error_patterns']}ê°œ")
            print(f"  - ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤: {wisdom_stats['best_practices']}ê°œ")
            
        except Exception as e:
            print(f"âš ï¸ Wisdom ë¡œë“œ ì‹¤íŒ¨: {e}")
    
    # 4. project_vision.md ë¡œë“œ
    vision_loaded = False
    vision_content = None
    
    if project_name and result.get('project_root'):
        vision_path = os.path.join(result['project_root'], 'project_vision.md')
        if os.path.exists(vision_path):
            try:
                with open(vision_path, 'r', encoding='utf-8') as f:
                    vision_content = f.read()
                vision_loaded = True
                print(f"\nğŸ“Œ í”„ë¡œì íŠ¸ ë¹„ì „ ë¬¸ì„œ ë¡œë“œ ì™„ë£Œ")
                
                # ì»¨í…ìŠ¤íŠ¸ì— ë¹„ì „ ì¶”ê°€
                if manager and manager.context:
                    manager.update_cache('project_vision', vision_content)
                    
            except Exception as e:
                print(f"âš ï¸ project_vision.md ë¡œë“œ ì‹¤íŒ¨: {e}")
    
    # 5. ê²°ê³¼ì— ì¶”ê°€ ì •ë³´ í¬í•¨
    result['wisdom_loaded'] = wisdom_loaded
    result['wisdom_stats'] = wisdom_stats
    result['vision_loaded'] = vision_loaded
    
    # ì»¨í…ìŠ¤íŠ¸ ì •ë³´ ê°•í™”
    if 'context' in result and manager and manager.context:
        result['context'].update({
            'wisdom_available': WISDOM_AVAILABLE,
            'wisdom_loaded': wisdom_loaded,
            'vision_loaded': vision_loaded,
            'context_synchronized': True
        })
    
    return result
