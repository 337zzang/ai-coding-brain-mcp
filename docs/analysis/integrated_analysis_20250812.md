
## 🎯 핵심 발견사항

### 1. scan_directory 문제
- **근본 원인**: file.py의 scan_directory 함수가 Tree 구조를 반환
- **영향**: UI 표시 및 파일 탐색 기능 제한
- **해결 방안**: 평면 dict 반환 옵션 추가 또는 별도 함수 생성

### 2. 경로 처리 불일치
- **문제**: 상대/절대 경로 처리 일관성 부족
- **영향**: search.files() 등 검색 기능 오작동
- **해결**: ProjectContext 클래스로 경로 관리 통일

### 3. O3 상태 관리
- **문제**: 메모리와 파일 상태 동기화 부족
- **영향**: 작업 추적 및 결과 수신 지연
- **해결**: 파일 기반 상태를 primary로 사용

## ⚡ 즉시 수정 가능한 항목

1. **scan_directory 개선** (file.py)
   - format 파라미터 추가: 'tree' | 'flat'
   - 기본값은 'flat'으로 변경

2. **search.files 경로 수정** (search.py)
   - os.path.join 사용으로 경로 결합
   - glob 패턴 정규화

3. **O3 상태 동기화** (llm.py)
   - 파일 우선 읽기
   - 메모리 캐시는 보조 용도

## 📅 실행 계획

### Phase 1 (오늘)
- [ ] scan_directory 수정
- [ ] search.files 경로 처리 개선
- [ ] 테스트 작성

### Phase 2 (이번 주)
- [ ] O3 상태 관리 개선
- [ ] 에러 메시지 표준화
- [ ] 문서 업데이트

### Phase 3 (다음 주)
- [ ] 성능 최적화
- [ ] 캐싱 시스템 도입
- [ ] 통합 테스트
